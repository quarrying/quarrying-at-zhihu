#! https://zhuanlan.zhihu.com/p/364346303
# 开源的植物识别模型

## 为什么做这个项目
用市面上的植物识别产品 (如花伴侣和形色等) 做批量化识别要收费; 虽然各个产品能识别的植物物种已经很多了, 但也有一些遗漏的, 扩展性不可控. 另外, 植物鉴别一直是笔者想培养的业余爱好, 机器学习和计算机视觉又是笔者的专业领域, 于是就萌生了做 **基于图像的植物识别模型** 的想法. 

## 项目概况
- 模型支持 1320 种植物的识别.
- 模型大小为 51.8M, 准确率在 90% 以上.
- 模型开源, 配套易用的示例代码.
- 支持的植物物种以及识别准确率会持续更新.


## 数据收集和整理

数据是深度学习模型的基石, 笔者花了大量的时间在数据收集和整理上.

数据的主要来源有: 百度图片, 必应图片, 微博, 百度贴吧, 新浪博客等. 除了微博, 其他都用了爬虫. 另外笔者还自己拍摄了一批图像.

爬虫爬取的图像的质量参差不齐, 标签可能有误, 且存在重复文件, 因此必须清洗. 笔者尝试的清洗方法包括自动化清洗, 半自动化清洗和手工清洗.

**自动化清洗**包括: 滤除小尺寸图像; 滤除宽高比很大或很小的图像; 滤除灰度图像; 根据图像感知哈希进行图像去重.

**半自动化清洗**包括: 利用预先训练的植物/非植物图像分类器得到的分数对文件进行重命名, 非植物图像应该有较低的得分; 利用前一阶段的植物分类器得到的分数对文件进行重命名, 不属于该物种的图像应该有较低的得分. 可以设置阈值, 滤除很低得分的文件; 另外在资源管理器选择按文件名排序, 也便于后续手工清洗掉非植物图像和不是该物种的植物.

**手工清洗**: 人工判断文件夹下图像是否属于文件夹名所标称的物种, 这需要相关的植物学专业知识, 是最耗时且枯燥的环节, 但也凭此认识了不少的植物.


## 数据现状

笔者把收集的数据集分为了正式集和候选集. 正式集中的物种基本上都认识, 目前包括 1320 种 (或亚种) 植物, 共 460352 张图像, 且里面每个物种的图像数基本上都在 100 张以上, 主要用来做训练. 候选集中的物种的图像比较少, 而且大部分对笔者来说是比较生疏的, 待图像量上来后会加入到正式集中. 

正式集的数据分布如下, 

![Image](https://pic4.zhimg.com/80/v2-8693e7b0b5e7c02d141150ab6d93f49f.png)


## 模型训练
骨干网络为 ResNet18, 网络结构略有调整, 损失函数为 softmax 交叉熵. 优化器为 SGD, 使用了 L2 正则化, 标签平滑正则化, 余弦退火学习率衰减策略和学习率预热.

训练了 30 个 epoch, 在 GTX 1660 上大概用了 39 个小时. 在自己构造的测试集上 (23026 张图像), Top1 准确率可以达到 94.0% (这个准确率应该是可用的了, 待以后有更高更多的算力, 笔者会尝试更多的方案, 如借鉴 FGIR, Person Re-ID 的方案, 模型蒸馏等).

注: 大家可以将模型改造成特征提取器, 用自己的植物图像来构造底库, 这样可以用图像检索的方式来进行植物识别, 可扩展性更高.


## 效果展示

![Image](https://pic4.zhimg.com/80/v2-9c306a0bc855424eae52ab25c3965286.png)

![Image](https://pic4.zhimg.com/80/v2-b1e820384a6744694e3046a2c94ae5c2.png)

![Image](https://pic4.zhimg.com/80/v2-95fc2625f13ff2cd2f5f193eb4789f67.png)

![Image](https://pic4.zhimg.com/80/v2-d1f5a46502ae69c0e2395506a3fe453e.png)


## 项目主页
<https://github.com/quarrying/quarrying-plant-id/>

欢迎 Star, PR 和 Fork.

## **更新记录**
- 20210413, 发布

## **版权声明**
版权声明: 自由分享, 保持署名-非商业用途-非衍生, 知识共享3.0协议.  
如果你对本文有疑问或建议, 欢迎留言! 转载请保留版权声明!

